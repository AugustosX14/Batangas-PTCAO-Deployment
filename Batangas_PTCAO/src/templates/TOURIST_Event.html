<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events - Batangas Explorer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #003366;
            --accent: #ff7e00;
            --light-bg: #f8f9fa;
            --shadow-light: 0 4px 15px rgba(0, 0, 0, 0.08);
            --shadow-medium: 0 8px 25px rgba(0, 0, 0, 0.12);
            --transition: all 0.3s ease;
            --gradient-primary: linear-gradient(135deg, #003366 0%, #004080 100%);
            --gradient-accent: linear-gradient(135deg, #ff7e00 0%, #ff9500 100%);
        }

         * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            line-height: 1.6;
        }

        html {
            scroll-behavior: smooth;
        }

        /* Navigation */
        .navbar {
            background-color: var(--primary);
            padding: 1rem 0;
            box-shadow: var(--shadow-medium);
            transition: var(--transition);
        }

        .navbar.scrolled {
            padding: 0.7rem 0;
            backdrop-filter: blur(10px);
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: white !important;
            transition: transform 0.3s ease;
        }

        .navbar-brand:hover {
            transform: translateY(-1px);
        }

        .navbar-brand img {
            margin-right: 10px;
        }

        .nav-link {
            color: white !important;
            font-weight: 500;
            padding: 0.5rem 1rem;
            position: relative;
            transition: var(--transition);
            border-radius: 5px;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 2px;
            background-color: var(--accent);
            transition: var(--transition);
            transform: translateX(-50%);
        }

        .nav-link:hover::after,
        .nav-link.active::after {
            width: 70%;
        }

        .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        /* Hero Section */
        .page-hero {
            background: var(--gradient-primary);
            color: white;
            padding: 8rem 0 4rem;
            margin-top: 76px;
            position: relative;
            overflow: hidden;
        }

        .page-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('https://images.unsplash.com/photo-1492684223066-81342ee5ff30?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80') center/cover;
            opacity: 0.1;
            z-index: 0;
        }

        .page-hero .container {
            position: relative;
            z-index: 1;
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
            animation: fadeInUp 1s ease-out;
        }

        .hero-subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            animation: fadeInUp 1s ease-out 0.3s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Filter Section */
        .filter-section {
            background: white;
            padding: 2rem 0;
            box-shadow: var(--shadow-light);
            margin-bottom: 2rem;
            position: sticky;
            top: 76px;
            z-index: 100;
        }

        .filter-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 0.6rem 1.5rem;
            border-radius: 25px;
            font-weight: 600;
            transition: var(--transition);
            cursor: pointer;
            font-size: 0.9rem;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: var(--gradient-primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .search-box {
            position: relative;
            min-width: 250px;
        }

        .search-input {
            width: 100%;
            padding: 0.6rem 1rem 0.6rem 2.5rem;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(255, 126, 0, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }

        /* Event Cards */
        .events-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .event-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow-light);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            height: fit-content;
            opacity: 0;
            transform: translateY(30px);
        }

        .event-card.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .event-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-medium);
        }

        .event-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: transform 0.4s ease;
            background-color: #f8f9fa;
        }

        .event-card:hover .event-image {
            transform: scale(1.05);
        }

        .event-content {
            padding: 1.8rem;
        }

        .event-date-badge {
            display: inline-flex;
            align-items: center;
            background: var(--gradient-accent);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px rgba(255, 126, 0, 0.3);
        }

        .event-date-badge.ongoing {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .event-date-badge.past {
            background: linear-gradient(135deg, #6c757d 0%, #8b949e 100%);
        }

        .event-date-badge i {
            margin-right: 0.5rem;
        }

        .event-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.8rem;
            line-height: 1.3;
        }

        .event-location {
            display: flex;
            align-items: center;
            color: #666;
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
        }

        .event-location i {
            color: var(--accent);
            margin-right: 0.5rem;
            width: 16px;
        }

        .event-description {
            color: #666;
            margin-bottom: 1.2rem;
            line-height: 1.6;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .event-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .event-tag {
            background: rgba(255, 126, 0, 0.1);
            color: var(--accent);
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 500;
            border: 1px solid rgba(255, 126, 0, 0.2);
        }

        .event-details {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-top: 1rem;
            border-top: 1px solid #f0f0f0;
        }

        .event-status {
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
        }

        .event-status.upcoming {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
        }

        .event-status.ongoing {
            background: rgba(255, 193, 7, 0.1);
            color: #ffc107;
        }

        .event-status.past {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
        }

        .btn-event {
            background: var(--gradient-accent);
            border: none;
            color: white;
            padding: 0.6rem 1.5rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            transition: var(--transition);
            text-decoration: none;
            display: inline-block;
        }

        .btn-event:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 126, 0, 0.4);
            color: white;
        }

        /* Featured Event */
        .featured-event {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow-medium);
            margin-bottom: 3rem;
            position: relative;
        }

        .featured-badge {
            position: absolute;
            top: 1.5rem;
            left: 1.5rem;
            background: var(--gradient-accent);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            z-index: 2;
            box-shadow: 0 2px 8px rgba(255, 126, 0, 0.3);
        }

        .featured-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            min-height: 400px;
        }

        .featured-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            background-color: #f8f9fa;
        }

        .featured-info {
            padding: 3rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .featured-date {
            color: var(--accent);
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .featured-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .featured-description {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .featured-location {
            display: flex;
            align-items: center;
            color: #666;
            margin-bottom: 2rem;
            font-size: 1rem;
        }

        .featured-location i {
            color: var(--accent);
            margin-right: 0.8rem;
            font-size: 1.2rem;
        }

        /* Loading States */
        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 3rem;
            color: var(--primary);
        }

        .loading-spinner i {
            font-size: 2rem;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .skeleton-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow-light);
            height: 450px;
        }

        .skeleton-image {
            width: 100%;
            height: 250px;
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        .skeleton-content {
            padding: 1.8rem;
        }

        .skeleton-line {
            height: 1rem;
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 4px;
            margin-bottom: 0.8rem;
        }

        .skeleton-line.short { width: 60%; }
        .skeleton-line.medium { width: 80%; }
        .skeleton-line.long { width: 100%; }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* No Results */
        .no-results {
            text-align: center;
            padding: 4rem 2rem;
            color: #666;
        }

        .no-results i {
            font-size: 4rem;
            color: #ddd;
            margin-bottom: 1rem;
        }

        .no-results h3 {
            color: var(--primary);
            margin-bottom: 1rem;
        }

        /* Error State */
        .error-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #dc3545;
        }

        .error-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .error-state h3 {
            margin-bottom: 1rem;
        }

        .retry-btn {
            background: var(--gradient-accent);
            border: none;
            color: white;
            padding: 0.8rem 2rem;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .retry-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 126, 0, 0.4);
        }

        /* View Toggle */
        .view-toggle {
            display: flex;
            background: white;
            border-radius: 25px;
            border: 2px solid var(--primary);
            overflow: hidden;
        }

        .view-btn {
            background: none;
            border: none;
            padding: 0.6rem 1.2rem;
            color: var(--primary);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .view-btn.active {
            background: var(--gradient-primary);
            color: white;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }

            .filter-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .search-box {
                min-width: auto;
                width: 100%;
            }

            .events-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .featured-content {
                grid-template-columns: 1fr;
            }

            .featured-info {
                padding: 2rem;
            }

            .featured-title {
                font-size: 1.8rem;
            }

            .filter-section {
                position: static;
            }
        }

        @media (max-width: 576px) {
            .page-hero {
                padding: 6rem 0 3rem;
            }

            .hero-title {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1.1rem;
            }

            .event-content {
                padding: 1.5rem;
            }

            .featured-info {
                padding: 1.5rem;
            }
        }

        /* Footer Styles */
        footer {
            background-color: var(--primary);
            padding: 3rem 0 1.5rem;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 3rem;
        }

        .footer-title {
            color: white;
            font-weight: 600;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
        }

        .footer-links {
            list-style: none;
            padding: 0;
        }

        .footer-links li {
            margin-bottom: 0.8rem;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: var(--accent);
            padding-left: 8px;
        }

        .social-icons {
            display: flex;
            gap: 10px;
            margin-top: 1rem;
        }

        .social-icon {
            width: 42px;
            height: 42px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: white;
            text-decoration: none;
        }

        .social-icon:hover {
            background-color: var(--accent);
            transform: translateY(-2px);
            color: white;
        }

        .copyright {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 1.5rem;
            margin-top: 2rem;
            text-align: center;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg fixed-top" id="navbar">
        <div class="container">
            <a class="navbar-brand" href="TOURIST_Home.html">
                <img src="{{ url_for('serve_static_file', filename='img/Batangas_Logo.png') }}" alt="Batangas Explorer Logo" width="50" height="50">
                Batangas Explorer
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/tourist/home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/tourist/destinations">Destinations</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/tourist/map">Map</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/tourist/events">Events</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/tourist/about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/tourist/contact">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Hero -->
    <section class="page-hero">
        <div class="container text-center">
            <h1 class="hero-title">Events & Festivals</h1>
            <p class="hero-subtitle">Discover exciting events, cultural festivals, and amazing experiences happening across Batangas Province throughout the year.</p>
        </div>
    </section>

    <!-- Filter Section -->
    <section class="filter-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <div class="filter-controls" id="filterControls">
                        <button class="filter-btn active" data-filter="all">All Events</button>
                        <button class="filter-btn" data-filter="festival">Festivals</button>
                        <button class="filter-btn" data-filter="cultural">Cultural</button>
                        <button class="filter-btn" data-filter="sports">Sports</button>
                        <button class="filter-btn" data-filter="food">Food & Culinary</button>
                        <button class="filter-btn" data-filter="nature">Nature & Adventure</button>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="d-flex gap-2">
                        <div class="search-box flex-grow-1">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" class="search-input" placeholder="Search events..." id="searchInput">
                        </div>
                        <div class="view-toggle">
                            <button class="view-btn active" data-view="grid"><i class="fas fa-th"></i></button>
                            <button class="view-btn" data-view="list"><i class="fas fa-list"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container my-5">
        <!-- Featured Event Section -->
        <div id="featuredEventSection">
            <!-- Featured event will be loaded here -->
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="loading-spinner">
            <i class="fas fa-spinner"></i>
            <span class="ms-3">Loading events...</span>
        </div>

        <!-- Error State -->
        <div id="errorState" class="error-state" style="display: none;">
            <i class="fas fa-exclamation-triangle"></i>
            <h3>Unable to Load Events</h3>
            <p>There was an error loading the events. Please check your connection and try again.</p>
            <button class="retry-btn" onclick="loadEvents()">
                <i class="fas fa-refresh me-2"></i>Try Again
            </button>
        </div>

        <!-- Events Grid -->
        <div class="events-grid" id="eventsGrid">
            <!-- Events will be loaded here dynamically -->
        </div>

        <!-- No Results Message -->
        <div class="no-results" id="noResults" style="display: none;">
            <i class="fas fa-search"></i>
            <h3>No Events Found</h3>
            <p>Try adjusting your search criteria or browse all events to discover exciting activities in Batangas.</p>
            <button class="btn-event" onclick="clearFilters()">
                <i class="fas fa-refresh me-2"></i>Show All Events
            </button>
        </div>
    </div>

    <!-- Footer -->
    <footer id="contact">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4 mb-lg-0">
                    <h5 class="footer-title">Batangas Explorer</h5>
                    <p>Your ultimate guide to discovering the natural wonders, cultural treasures, and culinary delights of Batangas Province. From pristine beaches to historical landmarks, we help you explore the best of what Batangas has to offer.</p>
                    <div class="social-icons">
                        <a href="#" class="social-icon" title="Follow us on Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="social-icon" title="Follow us on Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="social-icon" title="Follow us on Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="social-icon" title="Subscribe to our YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                    </div>
                </div>
                <div class="col-lg-2 col-md-4 mb-4 mb-md-0">
                    <h5 class="footer-title">Popular Destinations</h5>
                    <ul class="footer-links">
                        <li><a href="#">Taal Volcano Island</a></li>
                        <li><a href="#">Anilao Diving Sites</a></li>
                        <li><a href="#">Fortune Island</a></li>
                        <li><a href="#">Mount Batulao</a></li>
                        <li><a href="#">Calatagan Beaches</a></li>
                        <li><a href="#">Taal Heritage Town</a></li>
                    </ul>
                </div>
                <div class="col-lg-2 col-md-4 mb-4 mb-md-0">
                    <h5 class="footer-title">Quick Links</h5>
                    <ul class="footer-links">
                        <li><a href="#">Travel Guidelines</a></li>
                        <li><a href="#">Transportation Guide</a></li>
                        <li><a href="#">Weather Updates</a></li>
                        <li><a href="#">Emergency Contacts</a></li>
                        <li><a href="#">Tourism Offices</a></li>
                        <li><a href="#">Hotel Bookings</a></li>
                    </ul>
                </div>
                <div class="col-lg-4 col-md-4">
                    <h5 class="footer-title">Visit Batangas</h5>
                    <ul class="footer-links">
                        <li><i class="fas fa-map-marker-alt me-2"></i> Provincial Capitol Complex, Batangas City</li>
                        <li><i class="fas fa-phone me-2"></i> Hotline: (043) 980-2020</li>
                        <li><i class="fas fa-envelope me-2"></i> tourism@batangas.gov.ph</li>
                        <li><i class="fas fa-clock me-2"></i> Mon-Fri: 8:00 AM - 5:00 PM</li>
                        <li><i class="fas fa-globe me-2"></i> www.batangastourism.com</li>
                    </ul>
                    <div class="mt-3">
                        <small class="text-muted">Official tourism website of Batangas Province</small>
                    </div>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2025 Batangas Explorer. All rights reserved. | Provincial Tourism and Cultural Affairs Office</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Global variables
        let allEvents = [];
        let currentFilter = 'all';
        let currentSearch = '';
        let currentView = 'grid';

        // DOM elements
        const loadingState = document.getElementById('loadingState');
        const errorState = document.getElementById('errorState');
        const eventsGrid = document.getElementById('eventsGrid');
        const noResults = document.getElementById('noResults');
        const searchInput = document.getElementById('searchInput');
        const featuredEventSection = document.getElementById('featuredEventSection');

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initializeNavbar();
            loadFeaturedEvent();
            loadEvents();
            setupEventListeners();
        });

        // Navbar scroll effect
        function initializeNavbar() {
            window.addEventListener('scroll', function() {
                const navbar = document.getElementById('navbar');
                if (window.scrollY > 100) {
                    navbar.classList.add('scrolled');
                } else {
                    navbar.classList.remove('scrolled');
                }
            });
        }

        // Setup event listeners
        function setupEventListeners() {
            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.getAttribute('data-filter');
                    filterAndDisplayEvents();
                });
            });

            // Search input
            searchInput.addEventListener('input', function() {
                currentSearch = this.value.trim();
                filterAndDisplayEvents();
            });

            // View toggle
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentView = this.getAttribute('data-view');
                    toggleView();
                });
            });
        }

        // Load featured event
        async function loadFeaturedEvent() {
            try {
                const response = await fetch('/api/events/featured');
                const data = await response.json();

                if (data.success && data.featured_event) {
                    renderFeaturedEvent(data.featured_event);
                }
            } catch (error) {
                console.error('Error loading featured event:', error);
                // Continue without featured event
            }
        }

        // Load events from API
        async function loadEvents() {
            try {
                showLoadingState();

                const params = new URLSearchParams({
                    category: currentFilter === 'all' ? '' : currentFilter,
                    search: currentSearch,
                    upcoming_only: 'false' // Show all events including past ones
                });

                const response = await fetch(`/api/events?${params}`);
                const data = await response.json();

                if (data.success) {
                    allEvents = data.events;
                    renderEvents(allEvents);
                    hideLoadingState();
                } else {
                    throw new Error(data.error || 'Failed to load events');
                }
            } catch (error) {
                console.error('Error loading events:', error);
                showErrorState();
            }
        }

        // Filter and display events
        function filterAndDisplayEvents() {
            let filteredEvents = allEvents;

            // Apply category filter
            if (currentFilter !== 'all') {
                filteredEvents = filteredEvents.filter(event =>
                    event.category && event.category.toLowerCase().includes(currentFilter.toLowerCase())
                );
            }

            // Apply search filter
            if (currentSearch) {
                const searchLower = currentSearch.toLowerCase();
                filteredEvents = filteredEvents.filter(event =>
                    event.title.toLowerCase().includes(searchLower) ||
                    event.description.toLowerCase().includes(searchLower) ||
                    event.location.toLowerCase().includes(searchLower) ||
                    event.municipality.toLowerCase().includes(searchLower)
                );
            }

            renderEvents(filteredEvents);
        }

        // Handle image loading errors with proper fallback
        function handleImageError(img) {
            // Try different fallback options
            if (img.src !== '/static/images/default-event.jpg') {
                img.src = '/static/images/default-event.jpg';
            } else if (img.src !== 'https://images.unsplash.com/photo-1492684223066-81342ee5ff30?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80') {
                img.src = 'https://images.unsplash.com/photo-1492684223066-81342ee5ff30?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80';
            } else {
                // Final fallback - create a placeholder
                img.style.backgroundColor = '#f8f9fa';
                img.style.display = 'flex';
                img.style.alignItems = 'center';
                img.style.justifyContent = 'center';
                img.alt = 'Event Image';
                img.style.color = '#6c757d';
                img.style.fontSize = '14px';
                img.style.textAlign = 'center';

                // Create placeholder content
                const placeholder = document.createElement('div');
                placeholder.innerHTML = '<i class="fas fa-calendar-alt" style="font-size: 48px; margin-bottom: 10px;"></i><br>Event Image';
                placeholder.style.textAlign = 'center';
                placeholder.style.color = '#6c757d';

                img.parentNode.appendChild(placeholder);
                img.style.display = 'none';
            }
        }

        // Render featured event
        function renderFeaturedEvent(event) {
            const featuredHTML = `
                <div class="featured-event">
                    <div class="featured-badge">
                        <i class="fas fa-star me-1"></i>Featured Event
                    </div>
                    <div class="featured-content">
                        <img src="${event.image_url}" alt="${event.title}" class="featured-image" onerror="handleImageError(this)">
                        <div class="featured-info">
                            <div class="featured-date">
                                <i class="fas fa-calendar-alt me-2"></i>${event.date_display}
                            </div>
                            <h2 class="featured-title">${event.title}</h2>
                            <p class="featured-description">${event.description}</p>
                            <div class="featured-location">
                                <i class="fas fa-map-marker-alt"></i>
                                ${event.location}, ${event.municipality}
                            </div>
                            <a href="#" class="btn-event" onclick="showEventDetails(${event.event_id})">
                                <i class="fas fa-ticket-alt me-2"></i>Get Details
                            </a>
                        </div>
                    </div>
                </div>
            `;
            featuredEventSection.innerHTML = featuredHTML;
        }

        // Render events
        function renderEvents(events) {
            if (events.length === 0) {
                eventsGrid.innerHTML = '';
                showNoResults();
                return;
            }

            hideNoResults();

            const eventsHTML = events.map(event => createEventCard(event)).join('');
            eventsGrid.innerHTML = eventsHTML;

            // Animate cards
            setTimeout(() => {
                document.querySelectorAll('.event-card').forEach((card, index) => {
                    setTimeout(() => {
                        card.classList.add('visible');
                    }, index * 100);
                });
            }, 100);
        }

        // Create event card HTML
        function createEventCard(event) {
            const statusClass = event.status || 'upcoming';
            const statusText = event.is_ongoing ? 'Ongoing' :
                              event.is_upcoming ? 'Upcoming' : 'Past';

            const badgeClass = event.is_ongoing ? 'ongoing' :
                              event.is_past ? 'past' : '';

            const tags = generateEventTags(event);

            return `
                <div class="event-card" data-category="${event.category}">
                    <img src="${event.image_url}" alt="${event.title}" class="event-image"
                         onerror="handleImageError(this)">
                    <div class="event-content">
                        <div class="event-date-badge ${badgeClass}">
                            <i class="fas fa-calendar-alt"></i>
                            ${event.date_display}
                        </div>
                        <h3 class="event-title">${event.title}</h3>
                        <div class="event-location">
                            <i class="fas fa-map-marker-alt"></i>
                            ${event.location}, ${event.municipality}
                        </div>
                        <p class="event-description">${event.description}</p>
                        <div class="event-tags">
                            ${tags}
                        </div>
                        <div class="event-details">
                            <div class="event-status ${statusClass}">${statusText}</div>
                            <a href="#" class="btn-event" onclick="showEventDetails(${event.event_id})">
                                ${event.is_past ? 'View Details' : 'Learn More'}
                            </a>
                        </div>
                    </div>
                </div>
            `;
        }

        // Generate event tags
        function generateEventTags(event) {
            const tags = [];

            if (event.category) {
                tags.push(`<span class="event-tag">${event.category}</span>`);
            }

            if (event.is_ongoing) {
                tags.push(`<span class="event-tag">Live Now</span>`);
            } else if (event.is_upcoming) {
                tags.push(`<span class="event-tag">Upcoming</span>`);
            }

            // Add some default tags based on category
            const categoryTags = {
                'festival': ['Cultural', 'Community'],
                'sports': ['Competition', 'Active'],
                'food': ['Culinary', 'Tasting'],
                'cultural': ['Heritage', 'Traditional'],
                'nature': ['Outdoor', 'Adventure']
            };

            const additionalTags = categoryTags[event.category?.toLowerCase()] || [];
            additionalTags.forEach(tag => {
                if (tags.length < 3) {
                    tags.push(`<span class="event-tag">${tag}</span>`);
                }
            });

            return tags.join('');
        }

        // Show event details (placeholder function)
        function showEventDetails(eventId) {
            // This would typically open a modal or navigate to a detail page
            alert(`Event details for event ID: ${eventId}. This would typically show more information about the event.`);
        }

        // Toggle view between grid and list
        function toggleView() {
            if (currentView === 'list') {
                eventsGrid.style.gridTemplateColumns = '1fr';
                eventsGrid.style.maxWidth = '800px';
                eventsGrid.style.margin = '0 auto 3rem';
            } else {
                eventsGrid.style.gridTemplateColumns = 'repeat(auto-fit, minmax(350px, 1fr))';
                eventsGrid.style.maxWidth = 'none';
                eventsGrid.style.margin = '0 0 3rem 0';
            }
        }

        // Clear filters
        function clearFilters() {
            currentFilter = 'all';
            currentSearch = '';
            searchInput.value = '';

            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector('.filter-btn[data-filter="all"]').classList.add('active');

            filterAndDisplayEvents();
        }

        // Loading states
        function showLoadingState() {
            loadingState.style.display = 'flex';
            eventsGrid.style.display = 'none';
            errorState.style.display = 'none';
            noResults.style.display = 'none';
        }

        function hideLoadingState() {
            loadingState.style.display = 'none';
            eventsGrid.style.display = 'grid';
        }

        function showErrorState() {
            loadingState.style.display = 'none';
            eventsGrid.style.display = 'none';
            errorState.style.display = 'block';
            noResults.style.display = 'none';
        }

        function showNoResults() {
            noResults.style.display = 'block';
        }

        function hideNoResults() {
            noResults.style.display = 'none';
        }

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Enhanced hover effects for event cards
        document.addEventListener('mouseenter', function(e) {
            if (e.target.closest('.event-card')) {
                e.target.closest('.event-card').style.transform = 'translateY(-8px)';
            }
        }, true);

        document.addEventListener('mouseleave', function(e) {
            if (e.target.closest('.event-card')) {
                e.target.closest('.event-card').style.transform = 'translateY(0)';
            }
        }, true);
    </script>
</body>
</html>

